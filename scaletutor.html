<html>

<head>
    <script>
        frequency = (initalFrequency, halfSteps) => initalFrequency * (1.059463) ** (halfSteps)

        const majorHalfSteps = [0, 2, 4, 5, 7, 9, 11, 12, 11, 9, 7, 5, 4, 2, 0]
        const naturalMinorHalfSteps = [0, 2, 3, 5, 7, 8, 10, 12, 10, 8, 7, 5, 3, 2, 0]
        const harmonicMinorHalfSteps = [0, 2, 3, 5, 7, 8, 11, 12, 11, 8, 7, 5, 3, 2, 0]
        const melodicMinorHalfSteps = [0, 2, 3, 5, 7, 9, 11, 12, 10, 8, 7, 5, 3, 2, 0]
        const bluesHalfSteps = [0, 3, 5, 6, 7, 10, 12, 10, 7, 6, 5, 3, 0]

        const Notes = Object.freeze(
            {
                C3: -21,
                CS3: -20,
                D3: -19,
                DS3: -18,
                E3: -17,
                F3: -16,
                FS3: -15,
                G3: -14,
                GS3: -13,
                A3: -12,
                AS3: -11,
                B3: -10,
                C4: -9,
                CS4: -8,
                D4: -7,
                DS4: -6,
                E4: -5,
                F4: -4,
                FS4: -3,
                G4: -2,
                GS4: -1,
                A4: 0,
                AS4: 1,
                B4: 2,
                C5: 3,
                CS5: 4,
                D5: 5,
                DS5: 6,
                E5: 7,
                F5: 8,
                FS5: 9,
                G5: 10,
                GS5: 11,
                A5: 12
            }
        )

        function playScale(context, initialNote, halfSteps, noteDuration) {
            return new Promise((completionFunction) => {
                const oscillator = context.createOscillator();
                // oscillator.type = "sine";
                const initialFrequency = frequency(440, initialNote)
                halfSteps.forEach((halfStep, index) => {
                    oscillator.frequency.setValueAtTime(frequency(initialFrequency, halfStep), context.currentTime + index * noteDuration);
                })
                oscillator.connect(context.destination);
                oscillator.start(context.currentTime);
                oscillator.stop(context.currentTime + halfSteps.length * noteDuration)
                oscillator.onended = () => {
                    completionFunction()
                }
            })
        }

        async function playAllScales(context) {
            for (const scale of [
                majorHalfSteps,
                naturalMinorHalfSteps.map(note => note - 3),
                harmonicMinorHalfSteps.map(note => note - 3),
                melodicMinorHalfSteps.map(note => note - 3),
                bluesHalfSteps
            ]) {
                try {
                    await playScale(context, Notes.D4, scale, 0.25)
                } catch (error) {
                    console.log(error)
                }
            }
        }
        function doit() {
            const context = new (window.AudioContext || window.webkitAudioContext)();
            playAllScales(context)
        }
    </script>
</head>

<body>
    <button onclick="doit()">Click me</button>
</body>

</html>